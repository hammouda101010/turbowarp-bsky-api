<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <title>TurboButterfly OAuth Callback</title>
    <link rel="stylesheet" href="src/styles/auth.css">
    <link rel="apple-touch-icon" sizes="180x180" href="static/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="static/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="static/icons/favicon-16x16.png">
    <link rel="manifest" href="static/icons/site.webmanifest">
    <script type="module">
      import { BrowserOAuthClient } from "@atproto/oauth-client-browser"
    
      async function main() {
        const client =  new BrowserOAuthClient({
          clientMetadata: {
              "client_id": "https://hammouda101010.github.io/turbowarp-bsky-api/static/client-metadata.json",
              "client_name": "TurboWarp/Penguinmod",
              "client_uri": "https://hammouda101010.github.io/turbowarp-bsky-api",
              "logo_uri": "https://hammouda101010.github.io/turbowarp-bsky-api/static/icons/favicon.ico",
              "tos_uri": "https://scratch.mit.edu/terms_of_use",
              "policy_uri": "https://turbowarp.org/privacy.html",
              "redirect_uris": ["https://hammouda101010.github.io/turbowarp-bsky-api/redirect.html"],
              "scope": "atproto transition:generic",
              "grant_types": ["authorization_code", "refresh_token"],
              "response_types": ["code"],
              "token_endpoint_auth_method": "none",
              "application_type": "web",
              "dpop_bound_access_tokens": true
            },
          handleResolver: "https://bsky.social/",       
          responseMode: "query"
        })
        const params = new URLSearchParams(window.location.search) 
      
        await client.callback(params)
      }
      
      document.addEventListener('DOMContentLoaded', main)

    </script>
</head>
<body>
  <p id="auth_result">Processing OAuth Response...</p>
</body>
</html>